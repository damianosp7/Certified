<!DOCTYPE html>
<html xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity5"
      xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <title>File Upload / Download</title>
    <link rel="shortcut icon" type="image/ico" href="img/favicon.ico"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!--    <link rel="stylesheet" th:href="@{/css/style.css}">-->
    <link rel="stylesheet" href="./css/style.css">
    <link rel="stylesheet" href="./css/hovermenu.css">
    <link rel="stylesheet"
          href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
          integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
          crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="sweetalert2.min.js"></script>
    <link rel="stylesheet" href="sweetalert2.min.css">

    <!--  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>-->
    <!--  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>-->
    <!--  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>-->

    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="css/agency.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="http://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
    <link href='http://fonts.googleapis.com/css?family=Kaushan+Script' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic' rel='stylesheet'
          type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body style="background-color: #24bbff" id="page-top" class="index">
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>

<script src="/linkchains-bundle.js"></script>
<!--<div class="main">-->
<!--    <h3 style="color: white">Upload Multiple Files</h3>-->
<!--    <form id="uploadFiles" name="uploadFiles" method="post" th:action="@{/uploadFiles}" encType="multipart/form-data">-->
<!--        <div class="box-input">-->
<!--            <svg x="0px" y="0px" viewBox="0 0 64 62" style="enable-background:new 0 0 64 62;" xml:space="preserve">-->
<!--<style type="text/css">-->
<!--	.st0 {-->
<!--        fill: none;-->
<!--        stroke: #fff;-->
<!--        stroke-width: 2;-->
<!--        stroke-linecap: round;-->
<!--        stroke-linejoin: round;-->
<!--        stroke-miterlimit: 10;-->
<!--    }-->
<!--</style>-->
<!--                <g id="spa-launch">-->
<!--	<path class="st0" d="M33,27.1h-8c0,0-2-6-2-12c0-8,6-14,6-14s6,6,6,14C35,21.1,33,27.1,33,27.1z"/>-->
<!--                    <line class="st0" x1="29" y1="17.1" x2="29" y2="27.1"/>-->
<!--                    <polyline class="st0" points="25,27.1 17,27.1 17,23.1 23.1,17.1 	"/>-->
<!--                    <polyline class="st0" points="33,27.1 41,27.1 41,23.1 34.9,17.1 	"/>-->
<!--                    <path class="st0" d="M18,41.2c0.5-5.7,5.2-10.1,11-10.1c5.1,0,9.3,3.4,10.6,8.1"/>-->
<!--                    <path class="st0" d="M48,41.1c-0.2-3.4-3.1-6-6.5-6c-1.2,0-2.4,0.3-3.3,0.9"/>-->
<!--                    <path class="st0" d="M42.3,47.1c0,0-1-4-6-4"/>-->
<!--                    <path class="st0" d="M26.3,43.1c-3-1-4,2-4,2s-3-2-5,0s-1,4-1,4"/>-->
<!--                    <path class="st0" d="M9,46.1c-0.8-0.6-1.9-1-3-1c-2.8,0-5,2.2-5,5s2.2,5,5,5h46c2.8,0,5-2.2,5-5c0-5-4-9-9-9-->
<!--		c-0.9,0-1.8,0.1-2.6,0.4"/>-->
<!--                    <path class="st0" d="M18.8,37.9c-1.1-0.5-2.4-0.8-3.8-0.8c-4.6,0-8.5,3.5-8.9,8"/>-->
<!--</g>-->
<!--</svg>-->
<!--            <input type="file" name="files" multiple required/>-->
<!--            <button type="submit">Submit</button>-->
<!--        </div>-->
<!--    </form>-->
<!--</div>-->

<!--//Script for Qualichain Api-->
<script src="/js/recruitingScript.js"></script>
<div class="container">
    <div class="row">
        <div class="col-md-4 col-md-offset-4">
            <div class="panel panel-default" style="background-color: #179cff">
                <div class="panel-body">
                    <div class="text-center">
                        <h2 class="text-center" style="color: white">Upload Files</h2>
                        <p style="color: white">You can upload your file here.</p>
                        <label style="color: white" for="api">Choose an Api:</label>
                        <select style="color: #E85C99" id="api" name="api">
                            <option style="color: #E85C99" value="Qualichain">QualiChain</option>
                            <option style="color: #E85C99" value="BlockCerts">BlockCerts</option>
                        </select>
                        <div class="panel-body">

                            <form id="uploadFiles" name="uploadFiles" method="post" class="swa-confirm"
                                  th:action="@{/uploadFiles}"
                                  encType="multipart/form-data">
<!--                                <select style="color: #E85C99" id="api" name="api" >-->
<!--                                    <option style="color: #E85C99" value="Qualichain">QualiChain</option>-->
<!--                                    <option style="color: #E85C99" value="BlockCerts">BlockCerts</option>-->
<!--                                </select>-->
                                <div class="box-input">
                                    <div class="response" id="result">
                                        <p align="center" class="responseText" id="resultText">Result</p>
                                    </div>
                                    <svg x="0px" y="0px" viewBox="0 0 64 62" style="enable-background:new 0 0 64 62;"
                                         xml:space="preserve">
<style type="text/css">
	.st0 {
        fill: none;
        stroke: #fff;
        stroke-width: 2;
        stroke-linecap: round;
        stroke-linejoin: round;
        stroke-miterlimit: 10;
    }
</style>
                                        <g id="spa-launch">
	<path class="st0" d="M33,27.1h-8c0,0-2-6-2-12c0-8,6-14,6-14s6,6,6,14C35,21.1,33,27.1,33,27.1z"/>
                                            <line class="st0" x1="29" y1="17.1" x2="29" y2="27.1"/>
                                            <polyline class="st0" points="25,27.1 17,27.1 17,23.1 23.1,17.1 	"/>
                                            <polyline class="st0" points="33,27.1 41,27.1 41,23.1 34.9,17.1 	"/>
                                            <path class="st0"
                                                  d="M18,41.2c0.5-5.7,5.2-10.1,11-10.1c5.1,0,9.3,3.4,10.6,8.1"/>
                                            <path class="st0" d="M48,41.1c-0.2-3.4-3.1-6-6.5-6c-1.2,0-2.4,0.3-3.3,0.9"/>
                                            <path class="st0" d="M42.3,47.1c0,0-1-4-6-4"/>
                                            <path class="st0" d="M26.3,43.1c-3-1-4,2-4,2s-3-2-5,0s-1,4-1,4"/>
                                            <path class="st0" d="M9,46.1c-0.8-0.6-1.9-1-3-1c-2.8,0-5,2.2-5,5s2.2,5,5,5h46c2.8,0,5-2.2,5-5c0-5-4-9-9-9
		c-0.9,0-1.8,0.1-2.6,0.4"/>
                                            <path class="st0"
                                                  d="M18.8,37.9c-1.1-0.5-2.4-0.8-3.8-0.8c-4.6,0-8.5,3.5-8.9,8"/>
</g>
</svg>
                                    <div id="inputBoxHE" class="wrap-input100 validate-input m-b-16" data-validate = "Higher Education Institution ID is required">
                                        <input class="input100" type="text" id="HEId" style="color: black;" placeholder="Issuer ID" >
                                        <span class="focus-input100"></span>
                                    </div>

                                    <div id="inputBox" class="wrap-input100 validate-input m-b-16" data-validate = "Civil ID is required">
                                        <input class="input100" type="text" id="civilId" style="color: black" placeholder="Civil ID" >
                                        <span class="focus-input100"></span>
                                    </div>

                                    <div class="container-login100-form-btn m-t-17">
                                        <button type="button" onclick="verifyCertificate()" class="login100-form-btn btn btn-outline-secondary" id = "mybutton">
                                            Verify
                                        </button>
                                    </div>
                                    <input id="files" type="file" name="files"/>
                                    <button class="btn btn-primary authentication" type="submit">Check!</button>
                                    <button type="submit" id="submit" name="submit" class="submit submit-doc" disabled>Save</button>
                                    <br>
                                    <span id="message"></span>
                                </div>
                            </form>
<!--                            //sweet alert modal pop up form certification-->
                            <script>
                                $('.authentication').on('click', function (e) {

                                    var min = 0.01;
                                    var max = 0.99;
                                    var random = (Math.random() * (max - min) + min).toFixed(2);

                                    e.preventDefault();
                                    let form = $(this).parents('uploadFiles');
                                    let self = $(this);
                                    let input = document.getElementById('api').value;
                                    //check if file exists
                                    var fileInput = document.getElementById('files');
                                    var filePath = fileInput.value;
                                    // Allowing file type
                                    var allowedExtensions = /(\.doc|\.docx|\.odt|\.pdf|\.tex|\.txt|\.rtf|\.wps|\.wks|\.json|\.wpd)$/i;
                                    if (!allowedExtensions.exec(filePath)) {
                                        document.getElementById('message').style.color = 'red';
                                        document.getElementById('message').innerHTML = 'You have to upload a valid Document first...';
                                    } else {
                                        if (random > 0.5) {
                                            document.getElementById('message').innerHTML = '';
                                            document.getElementById('submit').disabled = false;
                                            Swal.fire({
                                                title: 'Your documents are Certified in ' + input + ' Api!',
                                                text: "You can save it by clicking the save button!",
                                                icon: 'success',
                                                // showCancelButton: true,
                                                // confirmButtonColor: '#3085d6',
                                                // cancelButtonColor: '#d33',
                                                confirmButtonText: 'Get more information'
                                            }).then((result) => {
                                                if (result.isConfirmed) {
                                                    // form.submit();
                                                    // $( "button[name=submit]" ).trigger('click');
                                                    // $('.swa-confirm').submit();
                                                    $(this).closest('form').submit();
                                                    Swal.fire({
                                                            title: 'Where to find it?',
                                                            text: 'You can find the documents in My Documents tab!',
                                                            icon: 'info',
                                                            showConfirmButton: false,
                                                        }
                                                    )
                                                    // location.href =  self.attr('href');
                                                }
                                            })
                                        }
                                        else{
                                            document.getElementById('message').innerHTML = '';
                                            document.getElementById('submit').disabled = true;
                                            Swal.fire({
                                                title: 'Your documents are NOT Certified in ' + input + ' Api..',
                                                text: "You can try again!",
                                                icon: 'error',
                                                // showCancelButton: true,
                                                // confirmButtonColor: '#3085d6',
                                                // cancelButtonColor: '#d33',
                                                confirmButtonText: 'Get more information'
                                            }).then((result) => {
                                                if (result.isConfirmed) {
                                                    // form.submit();
                                                    // $( "button[name=submit]" ).trigger('click');
                                                    // $('.swa-confirm').submit();
                                                    $(this).closest('form').submit();
                                                    Swal.fire({
                                                            title: 'Possible Solution!',
                                                            text: 'Try to choose different Api!',
                                                            icon: 'info',
                                                            showConfirmButton: false,
                                                        }
                                                    )
                                                    // location.href =  self.attr('href');
                                                }
                                            })
                                        }
                                    }
                                })
                            </script>

                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--******** hide or show Qualichain Fields *********-->
<script>
    $(document).ready(function () {
        $('#api').change(function () {
            if ($('#api').val() === 'Qualichain') {
                $('#HEId').show();
                $('#resultText').show();
                $('#civilId').show();
                $('#mybutton').show();
            }
            else{
                $('#HEId').hide();
                $('#resultText').hide();
                $('#civilId').hide();
                $('#mybutton').hide();
            }
        });
    });
</script>
<!--//Script for Blockcerts Api-->
<script src="/js/verifier-iife.js"></script>
<!--<script src="/js/verifier-iife2.js"></script>-->
<script src="https://requirejs.org/docs/release/2.3.5/minified/require.js"></script>
<script>
    // $('.authentication').on('click', async () => {
    //     let inputa = document.querySelector("input[type=file]");
    //     var input = inputa.value;
    //     let certificate = new Verifier.Certificate(input);
    //     let result = await certificate.verify();
    //     console.log('Certificate verification!!!!!!!!!!!!!!!!:', result.status);
    // });

    $('.authentication').on('click', async () => {

        const input = document.getElementById('files').files[0];
        // const input = document.querySelector("input[type=file]");
        console.log(input);

        const certificate = new Verifier.Certificate(input);
        console.log(certificate);
        await certificate.init();
        const verificationResult = await certificate.verify(({code, label, status, errorMessage}) => {
            console.log('Code:', code, label, ' - Status:', status);
            if (errorMessage) {
                console.log(`The step ${code} fails with the error: ${errorMessage}`);
            }
        });

        if (verificationResult.status === 'failure') {
            console.log(`The certificate is not valid. Error: ${verificationResult.errorMessage}`);
        }


        console.log('Certificate verification:', verificationResult.status);
    });

    // $('.authentication').on('click', async () => {
    //     const input = document.getElementById('files').files[0];
    //     // const input = document.querySelector("input[type=file]");
    // $.ajax({
    //     url: "https://api-ropsten.opencerts.io/verify",
    //     type: "POST",
    //     dataType: "json",
    //     contentType: "application/json; charset=utf-8",
    //     data: JSON.stringify(input),
    //     success: function (result) {
    //         console.log(result)
    //     },
    //     error: function (err) {
    //         console.log(err)
    //     }
    // }); // ajax call closing
    // });


    // $('.authentication').on('click', async () => {
    //
    //     let data = localStorage.getItem('C:/Users/da67-/IdeaProjects/Certified/src/main/resources/static/certificate.json')
    //     console.log(data);
    //
    //     let certificate = new Verifier.Certificate(data);
    //     const verificationResult = await certificate.verify(({code, label, status, errorMessage}) => {
    //         console.log('Code:', code, label, ' - Status:', status);
    //         if (errorMessage) {
    //             console.log(`The step ${code} fails with the error: ${errorMessage}`);
    //         }
    //     });
    //
    //     if (verificationResult.status === 'failure') {
    //         console.log(`The certificate is not valid. Error: ${verificationResult.errorMessage}`);
    //     }
    // });


    // var fs = require('fs');
    //
    // fs.readFile('./static/certificate.json', 'utf8', async function (err, data) {
    //     if (err) {
    //         console.log(err);
    //     }
    //
    //     let certificate = new Certificate(data);
    //     const verificationResult = await certificate.verify(({code, label, status, errorMessage}) => {
    //         console.log('Code:', code, label, ' - Status:', status);
    //         if (errorMessage) {
    //             console.log(`The step ${code} fails with the error: ${errorMessage}`);
    //         }
    //     });
    //
    //     if (verificationResult.status === 'failure') {
    //         console.log(`The certificate is not valid. Error: ${verificationResult.errorMessage}`);
    //     }
    // });

    // $('.authentication').on('click', function () {
    // let doc = document.getElementById("files").files[0];  // file from input
    // let req = new XMLHttpRequest();
    // let formData = new FormData();
    //
    // formData.append("certificate", doc);
    // req.open("POST", 'https://blockcerts.learningmachine.com/');
    // req.send(formData);
    // });

    // $('.authentication').on('click', async () => {
    //     let input = require('certificate.json');
    //     let certificate = new Verifier.Certificate(input);
    //     let result = await certificate.verify();
    //     console.log('Certificate verification33333:', result.status);
    // });

    // window.onload = async () => {
    //     const input = document.querySelector("input[type=file]");
    //     const certificate = new Verifier.Certificate(input);
    //     const result = await certificate.verify();
    //     console.log('Certificate verification!!!!!!!!!!!!!!!!:', result.status);
    //
    // }
</script>
<!--<script>-->
<!--    window.onload = function () {-->

<!--        let myForm = document.getElementById('uploadFiles');-->

<!--        myForm.onsubmit = function (event) {-->

<!--            event.preventDefault;-->

<!--            let myFile = document.getElementById('files');-->

<!--            let mySubmit = document.getElementById('submit');-->

<!--            let files = myFile.files;-->

<!--// Next code comes here-->

<!--            let request = new XMLHttpRequest();-->
<!--            request.open('GET', '../fixtures/mainnet-valid-2.0.json');-->
<!--            request.responseType = 'json';-->
<!--            request.onload = async () => {-->
<!--                const certificate = new Verifier.Certificate(request.response);-->

<!--                // Verify-->
<!--                const result = await certificate.verify();-->
<!--                console.log('Certificate verification:', result.status);-->
<!--            };-->
<!--            request.send();-->

<!--        }-->

<!--    };-->

<!--</script>-->
<!--/////Qualichain Verify Certificate//-->
<script>
    const fs = require('fs');
    const crypto = require('crypto');
    const Web3 = require('web3');
    const web3 = new Web3('https://ropsten.infura.io/v3/66a470c1158f441cac9c502cd63d4b9b');

    const consortiumAddress = '0x2CefB619218825C0c670D8E77f7039e0693E1dDC';
    const consortiumABI = [{"inputs":[],"payable":false,"stateMutability":"nonpayable","type":"constructor"},{"constant":false,"inputs":[{"internalType":"address","name":"id","type":"address"},{"internalType":"uint256","name":"vote","type":"uint256"}],"name":"cancelHEI","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"uint256","name":"vote","type":"uint256"}],"name":"changeThreshold","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"internalType":"address","name":"id","type":"address"}],"name":"getHEI","outputs":[{"internalType":"address","name":"add","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"getPollingInfo","outputs":[{"internalType":"address[]","name":"","type":"address[]"},{"internalType":"address[]","name":"","type":"address[]"},{"internalType":"address[]","name":"","type":"address[]"},{"internalType":"uint256","name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"id","type":"address"},{"internalType":"address","name":"contractAddress","type":"address"}],"name":"registerFounderHEI","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"id","type":"address"},{"internalType":"address","name":"contractAddress","type":"address"},{"internalType":"uint256","name":"vote","type":"uint256"}],"name":"registerHEI","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"}];
    const consortiumContract = new web3.eth.Contract(consortiumABI,consortiumAddress);

    const issuerContractABI = [{"constant":false,"inputs":[{"name":"id","type":"uint256"}],"name":"revokeCertificate","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"id","type":"uint256"}],"name":"verifyCertificate","outputs":[{"name":"hash","type":"bytes32"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"id","type":"uint256"},{"name":"hash","type":"bytes32"}],"name":"registerCertificate","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"inputs":[],"payable":false,"stateMutability":"nonpayable","type":"constructor"}];

    document.getElementById("mybutton").innerHTML = "Verify";

    function verifyCertificate() {
        var button = document.getElementById("mybutton");

        if(button.textContent === "Verify") {

            if(document.getElementById('files').files[0] != null) {
                var issuerId = checkIssuerId(document.getElementById("HEId").value);
                if(issuerId == null) {
                    return;
                }

                var id = checkCivilId(document.getElementById("civilId").value);
                if(id == null) {
                    return;
                }

                document.getElementById("resultText").style.color = "black";

                consortiumContract.methods.getHEI(issuerId).call((consortiumErr,issuerContractAddress) => {
                    console.log(issuerContractAddress);

                    if(consortiumErr == null && issuerContractAddress !== '0x0') {
                        const issuerContract = new web3.eth.Contract(issuerContractABI,issuerContractAddress);

                        issuerContract.methods.verifyCertificate(id).call((err,certificateHash) => {
                            if(err == null) {
                                var fileBytes = fs.readFileSync(document.getElementById('files').files[0].path);

                                var hashFunction = crypto.createHash('sha256');
                                hashFunction.update(fileBytes);
                                var bytes = hashFunction.digest();
                                var hashBytes = '0x' + bytes.toString('hex');

                                console.log(certificateHash);

                                if(hashBytes === certificateHash) {
                                    document.getElementById("inputBoxHE").style.display = "none";

                                    document.getElementById("inputBox").style.display = "none";

                                    document.getElementById("result").style.display = "block";

                                    document.getElementById("resultText").innerHTML = "Successful certificate verification";

                                    button.innerHTML = "Back";
                                }
                                else {
                                    document.getElementById("inputBoxHE").style.display = "none";

                                    document.getElementById("inputBox").style.display = "none";

                                    document.getElementById("result").style.display = "block";

                                    document.getElementById("resultText").innerHTML = "Certificate rejected";

                                    button.innerHTML = "Back";
                                }
                            }
                            else {
                                document.getElementById("inputBoxHE").style.display = "none";

                                document.getElementById("inputBox").style.display = "none";

                                document.getElementById("result").style.display = "block";

                                document.getElementById("resultText").innerHTML = "Verification failure. Try again";

                                button.innerHTML = "Back";
                            }
                        })
                    }
                    else if(issuerContractAddress === '0x0') {
                        document.getElementById("inputBoxHE").style.display = "none";

                        document.getElementById("inputBox").style.display = "none";

                        document.getElementById("result").style.display = "block";

                        document.getElementById("resultText").innerHTML = "Issuer ID does not match any contract";

                        button.innerHTML = "Back";
                    }
                    else {
                        document.getElementById("inputBoxHE").style.display = "none";

                        document.getElementById("inputBox").style.display = "none";

                        document.getElementById("result").style.display = "block";

                        document.getElementById("resultText").innerHTML = "Verification failure. Try again";

                        button.innerHTML = "Back";
                    }
                    button.type = "reset";
                })
            }
            else {
                document.getElementById("result").style.display = "block";
                document.getElementById("resultText").innerHTML = "Select a file to verify";
                document.getElementById("resultText").style.color = "red";
            }
        }
        else {
            document.getElementById("result").style.display = "none";

            document.getElementById("inputBoxHE").style.display = "block";

            document.getElementById("inputBox").style.display = "block";

            document.getElementById("files").value = "";

            button.innerHTML = "Verify";

        }
    }

    function checkIssuerId(strId) {
        if(strId == null || strId === '') {
            document.getElementById("result").style.display = "block";
            document.getElementById("resultText").innerHTML = "Insert a valid Issuer ID 1";
            document.getElementById("resultText").style.color = "red";
            return null;
        }
        var idArray = strId.split(':');
        if(idArray.length !== 3 || idArray[0] !== 'did' || idArray[1] !== 'ethr'){
            document.getElementById("result").style.display = "block";
            document.getElementById("resultText").innerHTML = "Insert a valid Issuer ID 2";
            document.getElementById("resultText").style.color = "red";
            return null;
        }
        else if(idArray[2].length !== 42 || idArray[2].slice(0,2) !== '0x') {
            document.getElementById("result").style.display = "block";
            document.getElementById("resultText").innerHTML = "Insert a valid Issuer ID 3";
            document.getElementById("resultText").style.color = "red";
            return null;
        }
        else if(!web3.utils.isAddress(idArray[2])) {
            document.getElementById("result").style.display = "block";
            document.getElementById("resultText").innerHTML = "Insert a valid Issuer ID 4";
            document.getElementById("resultText").style.color = "red";
            return null;
        }
        else {
            return idArray[2];
        }
    }

    function checkCivilId(strId) {
        if(strId == null || strId === '') {
            document.getElementById("result").style.display = "block";
            document.getElementById("resultText").innerHTML = "Insert a valid Civil ID";
            document.getElementById("resultText").style.color = "red";
            return null;
        }
        else if(isNaN(strId)){
            document.getElementById("result").style.display = "block";
            document.getElementById("resultText").innerHTML = "Insert a valid Civil ID";
            document.getElementById("resultText").style.color = "red";
            return null;
        }
        else {
            return parseInt(strId);
        }
    }
</script>
<style>
    body {
        background: #0CE9AF;
        display: flex;
        flex-direction: column;
        font-family: Lato;
        height: 100%;
        margin: auto;
        text-shadow: 0 0px 2px rgba(245, 245, 245, .25);
    }

    .box-input {
        text-align: center;
    }

    .box-input svg {
        width: 10rem;
        height: 10rem;
        vertical-align: middle;
        fill: currentColor;
    }

    form {
        color: #fff;
    }

    input[type="button" i],
    input[type="file" i]::-webkit-file-upload-button {
        display: none !important;
    }


    .box-input label {
        margin: auto;
        text-overflow: ellipsis;
        white-space: nowrap;
        color: #fff;
        cursor: pointer;
        text-align: center;
        display: block;
        overflow: hidden;
    }

    .submit {
        background: #0CE9AF;
        border: none;
        box-shadow: 0 2px 4px rgba(0, 0, 0, .25);
        color: #fff;
        display: flex;
        font-size: 1.25rem;
        font-weight: 700;
        margin: auto;
        margin-top: 2.5rem;
        overflow: auto;
        padding: 1rem 1.5rem;
    }

    .submit:hover {
        box-shadow: 0 4px 12px rgba(0, 0, 0, .5);
    }

    .submit:active {
        box-shadow: none;
    }


    @keyframes appear-from-inside {
        from {
            transform: translateY(-50%) scale(0);
        }
        75% {
            transform: translateY(-50%) scale(1.1);
        }
        to {
            transform: translateY(-50%) scale(1);
        }
    }

    input,
    textarea,
    select {
        border-radius: 0;
        border: none;
    }

    input {
        line-height: normal;
    }

    .box.has-advanced-upload .box-dragndrop {
        display: inline;
    }

    strong {
        color: #fff;
    }

</style>

<!-- Navigation User -->
<nav class="navbar navbar-default navbar-fixed-top" sec:authorize="hasAnyAuthority('ROLE_USER')">
    <div class="container" style="display: inline">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse"
                    data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand page-scroll" href="/">Certified</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right" style="display: inline">
                <li class="hidden">
                    <a href="#page-top"></a>
                </li>
                <li>
                    <a class="active" href="/user">My Account</a>
                </li>
                <li>
                    <a class="breadcrumb-item" href="/operation/user">My Documents</a>
                </li>
                <li>
                    <a class="breadcrumb-item" href="/about">About</a>
                </li>
                <li>
                    <a class="breadcrumb-item" href="/contact">Contact</a>
                </li>
                <li>
                    <a class="breadcrumb-item" href="/logout">Logout</a>
                </li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container-fluid -->
</nav>

<!-- Navigation Admin -->
<nav class="navbar navbar-default navbar-fixed-top" sec:authorize="hasAnyAuthority('ROLE_ADMIN')">
    <div class="container" style="display: inline">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse"
                    data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand page-scroll" href="/">Certified</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right" style="display: inline">
                <li class="hidden">
                    <a href="#page-top"></a>
                </li>
                <!--                <li>-->
                <!--                    <a class="breadcrumb-item" href="/user">My Account</a>-->
                <!--                </li>-->
                <li>
                    <a href="/users">Users Accounts</a>
                </li>
                <li>
                    <a class="breadcrumb-item" href="/operation/user">My Documents</a>
                </li>
                <li>
                    <a href="/operation/users">Users Documents</a>

                </li>
                <li>
                    <a class="breadcrumb-item" href="/logout">Logout</a>
                </li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container-fluid -->
</nav>


<!-- jQuery -->
<script src="js/jquery.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="js/bootstrap.min.js"></script>

<!-- Plugin JavaScript -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js"></script>
<script src="js/classie.js"></script>
<script src="js/cbpAnimatedHeader.js"></script>


<!-- Custom Theme JavaScript -->
<script src="js/agency.js"></script>

</body>
</html>